<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>2.2. Configuration &#8212; Clone Cloud Store [CCS] 0.8 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b3523f8e" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=472322c9" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <script src="../_static/documentation_options.js?v=f82dc3d9"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.3. Open API" href="OpenAPI.html" />
    <link rel="prev" title="2.1. BPMN for Accessor" href="BPMN.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  <div class="document">
    
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Architecture/index.html">1. Architecture</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">2. Accessor</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="BPMN.html">2.1. BPMN for Accessor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">2.2. Configuration</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#various-accessor-services">2.2.1. Various Accessor services</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#accessor-replicator">2.2.1.1. Accessor-Replicator</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-simple-gateway">2.2.1.2. Accessor-Simple-Gateway</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-server">2.2.1.3. Accessor-Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#client-with-apache-httpclient5">2.2.2. Client with Apache httpclient5</a></li>
<li class="toctree-l3"><a class="reference internal" href="#application-yaml-configuration">2.2.3. application.yaml configuration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#client-configurations">2.2.3.1. Client configurations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-replicator-configuration">2.2.3.2. Accessor Replicator configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-configuration">2.2.3.3. Accessor configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-simple-gateway-configuration">2.2.3.4. Accessor Simple Gateway configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-common-configuration">2.2.3.5. Accessor common configuration</a><ul>
<li class="toctree-l5"><a class="reference internal" href="#specific-driver-configurations">2.2.3.5.1. Specific Driver configurations</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="#accessor-buffered-configuration">2.2.3.6. Accessor buffered configuration</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="OpenAPI.html">2.3. Open API</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Replicator/index.html">3. Replicator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Reconciliator/index.html">4. Reconciliator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Administration/index.html">5. Administration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">6. Object Storage Driver</a></li>
<li class="toctree-l1"><a class="reference internal" href="../common/index.html">7. Commons</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Dev/index.html">8. Dev Detail</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html"><span class="section-number">2. </span>Accessor</a><ul>
      <li>Previous: <a href="BPMN.html" title="previous chapter"><span class="section-number">2.1. </span>BPMN for Accessor</a></li>
      <li>Next: <a href="OpenAPI.html" title="next chapter"><span class="section-number">2.3. </span>Open API</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="configuration">
<h1><span class="section-number">2.2. </span>Configuration<a class="headerlink" href="#configuration" title="Link to this heading">¶</a></h1>
<section id="various-accessor-services">
<h2><span class="section-number">2.2.1. </span>Various Accessor services<a class="headerlink" href="#various-accessor-services" title="Link to this heading">¶</a></h2>
<section id="accessor-replicator">
<h3><span class="section-number">2.2.1.1. </span>Accessor-Replicator<a class="headerlink" href="#accessor-replicator" title="Link to this heading">¶</a></h3>
<p>Used by remote request from Replicator. It listens to a Topic <code class="docutils literal notranslate"><span class="pre">replicator-action-in</span></code> from (local) Remote Replicator and is
able, through the Local Replicator to access to remote Object if needed for local creation (clone)
or to Accessor Internal Service.</p>
<p>This service has no API and only uses a Topic as incoming requests.</p>
</section>
<section id="accessor-simple-gateway">
<h3><span class="section-number">2.2.1.2. </span>Accessor-Simple-Gateway<a class="headerlink" href="#accessor-simple-gateway" title="Link to this heading">¶</a></h3>
<p>Simple Cloud Storage Gateway without any database and replication nor reconciliation support.</p>
<p>It is means for an easy move from existing storage to Cloud Clone Store, to later on apply the real Accessor service.</p>
<p>For instance the steps could be:</p>
<ul class="simple">
<li><p>Add this Simple Gateway in front of an application for existing buckets</p></li>
<li><p>In parallel, import the content of those buckets using the special procedure (see Reconcilitator import from existing
Storage) such that all buckets and associated objects are in the CCS database</p></li>
<li><p>Once import done, the Simple Gateway could be shutdown to let the Accessor Server replacing it, while the application
still can access to the buckets and associated objects</p></li>
<li><p>When a new site is build, a replication can be setup such that the full services are offer to the
application (using Reconciliator for instance special procedure for new and empty replication site or
through standard Reconciliator process for an existing (partial or not) remote site)</p></li>
</ul>
<p><em>Note that this version has only Ownership control over deletion of a bucket, not any specific control
on other operations such as read, create or delete an object within a bucket.</em></p>
</section>
<section id="accessor-server">
<h3><span class="section-number">2.2.1.3. </span>Accessor-Server<a class="headerlink" href="#accessor-server" title="Link to this heading">¶</a></h3>
<p>Used by application (clients) to interact with Cloud Storage, enabling replication and remote access and reconciliation,
using the public API.</p>
<p>It is also used internally by all services when they need to access or interact with buckets and objects, through the
internal API, which must be not available to other services than Cloud Clone Store itself.</p>
<p><em>Note that this version has full Ownership control over deletion of a bucket, but also
on other operations such as read, create or delete an object within a bucket from any client.</em></p>
</section>
</section>
<section id="client-with-apache-httpclient5">
<h2><span class="section-number">2.2.2. </span>Client with Apache httpclient5<a class="headerlink" href="#client-with-apache-httpclient5" title="Link to this heading">¶</a></h2>
<p>In order to allow more applications to use Clone Cloud Store, an Apache httpclient 5 based CCS client is also
available in <strong>ccs-accessor-client-apache</strong>.</p>
<p>Dependencies is minimal while all functionalities are supported.</p>
<p>Quarkus is not required.</p>
</section>
<section id="application-yaml-configuration">
<h2><span class="section-number">2.2.3. </span>application.yaml configuration<a class="headerlink" href="#application-yaml-configuration" title="Link to this heading">¶</a></h2>
<section id="client-configurations">
<h3><span class="section-number">2.2.3.1. </span>Client configurations<a class="headerlink" href="#client-configurations" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id1">
<caption><span class="caption-text">Accessor Cloud Clone Store Client Configuration</span><a class="headerlink" href="#id1" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.accessor.client.api.AccessorBucketApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.accessor.client.api.AccessorObjectApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id2">
<caption><span class="caption-text">Accessor Cloud Clone Store Internal Client Configuration</span><a class="headerlink" href="#id2" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.accessor.client.internal.api.AccessorBucketInternalApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.accessor.client.internal.api.AccessorObjectInternalApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
</tr>
</tbody>
</table>
</section>
<section id="accessor-replicator-configuration">
<h3><span class="section-number">2.2.3.2. </span>Accessor Replicator configuration<a class="headerlink" href="#accessor-replicator-configuration" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id3">
<caption><span class="caption-text">Accessor Replicator Cloud Clone Store Service Configuration</span><a class="headerlink" href="#id3" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 40.0%" />
<col style="width: 40.0%" />
<col style="width: 20.0%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property or Environment variable</p></th>
<th class="head"><p>Possible Values</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.site</span></code></p></td>
<td><p>Name of the site</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">unconfigured</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.internal.compression</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, True to allow compression between services</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Redefining <code class="docutils literal notranslate"><span class="pre">mp.messaging.incoming.replicator-action-in</span></code> or env <code class="docutils literal notranslate"><span class="pre">CCS_REQUEST_ACTION</span></code></p></td>
<td><p>Name of the incoming topic for Action Requests (if more than 1 instance, add broadcast=true to the configuration)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">request-action</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.mongodb.database</span></code></p></td>
<td><p>Name of the associated database (if MongoDB used, with ccs.db.type = mongo)</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.replicator.client.api.LocalReplicatorApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.administration.client.api.OwnershipApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="accessor-configuration">
<h3><span class="section-number">2.2.3.3. </span>Accessor configuration<a class="headerlink" href="#accessor-configuration" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id4">
<caption><span class="caption-text">Accessor Cloud Clone Store Service Configuration</span><a class="headerlink" href="#id4" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 37.0%" />
<col style="width: 37.0%" />
<col style="width: 25.9%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property or Environment variable</p></th>
<th class="head"><p>Possible Values</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.site</span></code></p></td>
<td><p>Name of the site</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">unconfigured</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.remote.read</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, True to allow remote access when object not locally found</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.remote.fixOnAbsent</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, True to allow to fix using remote accessed object</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.internal.compression</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code> or <code class="docutils literal notranslate"><span class="pre">false</span></code>, True to allow compression between services</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">false</span></code></p></td>
</tr>
<tr class="row-even"><td><p>Redefining <code class="docutils literal notranslate"><span class="pre">mp.messaging.outgoing.replicator-action-out</span></code> or env <code class="docutils literal notranslate"><span class="pre">CCS_REQUEST_ACTION</span></code></p></td>
<td><p>Name of the outgoing topic for Action Requests</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">request-action</span></code></p></td>
</tr>
<tr class="row-odd"><td><p>Redefining <code class="docutils literal notranslate"><span class="pre">mp.messaging.outgoing.replicator-request-out</span></code> or env <code class="docutils literal notranslate"><span class="pre">CCS_REQUEST_REPLICATION</span></code></p></td>
<td><p>Name of the outgoing topic for Replication Requests</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">request-replication</span></code></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.mongodb.database</span></code></p></td>
<td><p>Name of the associated database (if MongoDB used, with ccs.db.type = mongo)</p></td>
<td></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.replicator.client.api.LocalReplicatorApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
<td></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.administration.client.api.OwnershipApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="accessor-simple-gateway-configuration">
<h3><span class="section-number">2.2.3.4. </span>Accessor Simple Gateway configuration<a class="headerlink" href="#accessor-simple-gateway-configuration" title="Link to this heading">¶</a></h3>
<table class="docutils align-default" id="id5">
<caption><span class="caption-text">Accessor Simple Gateway Cloud Clone Store Service Configuration</span><a class="headerlink" href="#id5" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.site</span></code></p></td>
<td><p>Name of the site</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">unconfigured</span></code></p></td>
</tr>
</tbody>
</table>
</section>
<section id="accessor-common-configuration">
<h3><span class="section-number">2.2.3.5. </span>Accessor common configuration<a class="headerlink" href="#accessor-common-configuration" title="Link to this heading">¶</a></h3>
<p>For both <em>Accessor Replicator Cloud Clone Store Service</em> and <em>Accessor Cloud Clone Store Service</em>,
an extra configuration is needed according to the Storage Driver used:</p>
<section id="specific-driver-configurations">
<h4><span class="section-number">2.2.3.5.1. </span>Specific Driver configurations<a class="headerlink" href="#specific-driver-configurations" title="Link to this heading">¶</a></h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note for S3 that <code class="docutils literal notranslate"><span class="pre">maxPartSizeForUnknownLength</span></code> or <code class="docutils literal notranslate"><span class="pre">driverMaxChunkSize</span></code> should be defined according to memory available
and concurrent access, as each transfer (upload or download) could lead to one buffer of this size for each.</p>
</div>
<table class="docutils align-default" id="id6">
<caption><span class="caption-text">Driver for S3 Service Configuration</span><a class="headerlink" href="#id6" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.s3.host</span></code></p></td>
<td><p>S3 Host (do not use <code class="docutils literal notranslate"><span class="pre">quarkus.s3.endpoint-override</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.s3.keyId</span></code></p></td>
<td><p>S3 KeyId (do not use <code class="docutils literal notranslate"><span class="pre">quarkus.s3.aws.credentials.static-provider.access-key-id</span></code> nor <code class="docutils literal notranslate"><span class="pre">aws.accessKeyId</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.s3.key</span></code></p></td>
<td><p>S3 Key (do not use <code class="docutils literal notranslate"><span class="pre">quarkus.s3.aws.credentials.secret-access-key</span></code> nor <code class="docutils literal notranslate"><span class="pre">aws.secretAccessKey</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.s3.region</span></code></p></td>
<td><p>S3 Region (do not use <code class="docutils literal notranslate"><span class="pre">quarkus.s3.aws.region</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.s3.maxPartSize</span></code></p></td>
<td><p>MultiPart size (minimum 5 MB, maximum 5 GB, default 256 MB)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.s3.maxPartSizeForUnknownLength</span></code></p></td>
<td><p>512 MB as in <code class="docutils literal notranslate"><span class="pre">ccs.driverMaxChunkSize</span></code>, MultiPart size (minimum 5 MB, maximum ~2 GB): will be used to buffer InputStream if length is unknown, so take  care of the Memory consumption associated (512 MB, default, will limit the total InputStream length to 5 TB since 10K parts)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id7">
<caption><span class="caption-text">Driver for Azure Blob Storage Service Configuration</span><a class="headerlink" href="#id7" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 33.3%" />
<col style="width: 66.7%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.azure.storage.blob.connection-string</span></code></p></td>
<td><p>Connection String to Azure Blob Storage (see <a class="reference external" href="https://docs.quarkiverse.io/quarkus-azure-services/dev/index.html">https://docs.quarkiverse.io/quarkus-azure-services/dev/index.html</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.azure.maxConcurrency</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">2</span></code>, Maximum concurrency in upload/download with Azure Blob Storage</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.azure.maxPartSize</span></code></p></td>
<td><p>256 MB, MultiPart size (minimum 5 MB, maximum 4 GB, default 256 MB)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.azure.maxPartSizeForUnknownLength</span></code></p></td>
<td><p>512 MB as in <code class="docutils literal notranslate"><span class="pre">ccs.driverMaxChunkSize</span></code>, MultiPart size (minimum 5 MB, maximum ~2 GB): will be used to buffer InputStream if length is unknown (no memory impact)</p></td>
</tr>
</tbody>
</table>
<table class="docutils align-default" id="id8">
<caption><span class="caption-text">Driver for Google Cloud Storage Service Configuration</span><a class="headerlink" href="#id8" title="Link to this table">¶</a></caption>
<colgroup>
<col style="width: 38.5%" />
<col style="width: 61.5%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.google.cloud.project-id</span></code></p></td>
<td><p>Project Id in Google Cloud (and related Authentication see <a class="reference external" href="https://docs.quarkiverse.io/quarkus-google-cloud-services/main/index.html">https://docs.quarkiverse.io/quarkus-google-cloud-services/main/index.html</a>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.google.disableGzip</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">true</span></code>, Default is to use Gzip content, but may be disabled (default: true so disabled)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.google.maxPartSize</span></code></p></td>
<td><p>256 MB, MultiPart size (minimum 5 MB, maximum 4 GB, default 256 MB) (<strong>Property ignored</strong>)</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.driver.google.maxBufSize</span></code></p></td>
<td><p>128 MB; MultiPart size (minimum 5 MB, maximum ~2 GB): will be used to buffer InputStream if length is unknown (no memory impact)</p></td>
</tr>
</tbody>
</table>
<p>Accessor calls Ownership service to check or create ownership for each bucket.</p>
<table class="docutils align-default" id="id9">
<caption><span class="caption-text">Ownership Cloud Clone Store Client Configuration</span><a class="headerlink" href="#id9" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">quarkus.rest-client.&quot;io.clonecloudstore.administration.client.api.OwnershipApi&quot;.url</span></code></p></td>
<td><p>Http(s) url of the service</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="accessor-buffered-configuration">
<h3><span class="section-number">2.2.3.6. </span>Accessor buffered configuration<a class="headerlink" href="#accessor-buffered-configuration" title="Link to this heading">¶</a></h3>
<p>For both <em>Accessor Simple Gateway Cloud Clone Store Service</em> and <em>Accessor Cloud Clone Store Service</em>,
an extra configuration could be set to allow buffered streams.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The buffered configuration is intend to protect against non resilient Driver services.
But it is at the cost of an extra storage on the Accessor service to store temporarily
the uploaded stream, until they are in the Driver final service.
<strong>This implies to “guess” how many local storage space is needed.</strong></p>
</div>
<p>This option should not be activated in general, but allows to handle final Driver service that
have a bad resilience, at the price of extra local storage.</p>
<p>The global logic is the following:</p>
<ul class="simple">
<li><p>When an upload occurs, the inputStream is first backup into the local filesystem.</p></li>
<li><p>Once backuped, it is then uploaded to the Driver.</p></li>
<li><p>If the Driver upload is in success, the local copy is deleted.</p></li>
<li><p>On the contrary, in case of failure, the local copy remains and is add to an asynchronous retry handler.</p>
<ul>
<li><p>The related item in database has a READY status, even if not uploaded in Driver service</p></li>
</ul>
</li>
</ul>
<p>When an access is tried on a Driver Object, the global logic is the following:</p>
<ul class="simple">
<li><p>If the Driver access is in error, there is an extra try using the local filesystem</p></li>
</ul>
<p>When a delete occurs on a Driver Object, there is a try to delete also from the local filesystem.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When having multiple instances of Accessor, if one wants to not rely on which server
the call occurs, one can share the extra storage (using NFS for instance).
If not, access and delete will not benefit other instances.</p>
</div>
<p>The filesystem is as much as possible guard to prevent no more space on device:</p>
<ul class="simple">
<li><p>An option specifies how much space in GB must be available for any upload</p></li>
<li><p>If the upload inputStream size is known, the size is compared to the available space</p></li>
<li><p>In any case where the filesystem is not enough, the local copy will be skipped, therefore
relying only on the Driver availability</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This protection can prevent buffered operations due to the lack of space.
In this case, the upload relies only on the Driver availability, which is the
default behavior.</p>
</div>
<p>For any buffered and not yet store to Driver service items, there is an extra backgroung
task that will take them in consideration. The schedule is every <code class="docutils literal notranslate"><span class="pre">ccs.accessor.store.schedule.delay</span></code>.</p>
<ul class="simple">
<li><p>The background task check first if any item shall be uploaded to the Driver</p>
<ul>
<li><p>It checks the availability in the database (status) and the availability of the Driver
service and the item is still missing</p></li>
<li><p>If everything is OK, it uploads the item and then delete locally the item</p></li>
<li><p>On the contrary</p>
<ul>
<li><p>If the item is already in the Driver, it is deleted</p></li>
<li><p>If the item is not in the Driver, it is reset to the next schedule</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Once all scheduled tasks are over</p>
<ul>
<li><p>It checks too old items and clean them according to the <code class="docutils literal notranslate"><span class="pre">purge.retention_seconds`</span></code> configuration</p>
<ul>
<li><p>For each item, the associated entry status in database is placed as <code class="docutils literal notranslate"><span class="pre">ERR_UPL`</span></code></p></li>
</ul>
</li>
<li><p><strong>Important note: once purged, the items cannot be uploaded anymore automatically</strong></p></li>
</ul>
</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Most of the normal behaviors of Driver are respected using the buffered space, except
listing, streaming of StorageObjects and test of existence of a directory (object is checked but
not directory).</p>
</div>
<table class="docutils align-default" id="id10">
<caption><span class="caption-text">Buffered upload Cloud Clone Store Service Configuration</span><a class="headerlink" href="#id10" title="Link to this table">¶</a></caption>
<thead>
<tr class="row-odd"><th class="head"><p>Property/Yaml property</p></th>
<th class="head"><p>Possible Values</p></th>
<th class="head"><p>Default Value</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.store.active</span></code></p></td>
<td><p>true / false</p></td>
<td><p>false and should be used with caution</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.store.path</span></code></p></td>
<td><p>Path to the root for the local store</p></td>
<td><p>Temp directory according to io.java.tmpdir (/CCS will be added)</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.store.min_space_gb</span></code></p></td>
<td><p>integer as number of GB</p></td>
<td><p>5 GB by default, should be set according to average upload sizes and duration of unavailability of Driver final service</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.store.purge.retention_seconds</span></code></p></td>
<td><p>delay in seconds before purge</p></td>
<td><p>3600 seconds (1 hour) by default, should be set according to space on local storage</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">ccs.accessor.store.schedule.delay</span></code></p></td>
<td><p>delay in duration format (“10s”, “1m”…), a number will be considered in seconds by default</p></td>
<td><p>“10s” (10 seconds) by default, should be set according to space on local storage, upload frequency and Driver service stability</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
    <div class="clearer"></div>
  </div>
    <div class="footer">
      &copy;2022, Frederic Bregier.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/Accessor/Configuration.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>